<?php

/**
 * @file
 * Connects data from the Observant Records database to Drupal.
 *
 */

require_once('observantrecords.model.inc');

function observantrecords_help($path, $arg) {
	switch ($path) {
		case "admin/help#observantrecords":
			return '<p>' . t('Connects Drupal to Observant Records data') . '</p>';
			break;
	}
}

function observantrecords_contents() {
	$results = observantrecords_get_artists();
	return $results;
}

function observantrecords_block_info() {
	$blocks['observantrecords'] = array(
		'info' => t('Artists'),
		'cache' => DRUPAL_CACHE_PER_ROLE,
	);
	return $blocks;
}

function observantrecords_block_view($delta = '') {
	switch($delta) {
		case 'observantrecords':
			$block['subject'] = t('Artists');
			if (user_access('access content')) {
				$result = observantrecords_contents();
				$items = array();
				foreach ($result as $node) {
					$items[] = array(
						'data' => $node->artist_last_name,
					);
				}

				if (empty($items)) {
					$block['content'] = t('No artists to display');
				} else {
					$block['content'] = theme('item_list', array('items' => $items));
				}
			}
			break;
	}

	return $block;
}

